import{d as k,u as b}from"./firestore.Ghab-HAF.js";import"./firebase.D9-hzClm.js";let l=null,s=null;function I(e,r,n,t,d,o,c,p){console.log("Abriendo modal de edición para:",r),l=e;const a=document.getElementById("edit-product-modal"),g=document.getElementById("edit-product-name"),f=document.getElementById("edit-product-description"),E=document.getElementById("edit-product-price"),y=document.getElementById("edit-product-image"),v=document.getElementById("edit-product-category"),h=document.getElementById("edit-product-stock"),w=document.getElementById("edit-product-featured");a&&g&&f&&E&&y&&v&&h&&w?(g.value=r,f.value=n,E.value=t.toString(),y.value=d,v.value=o,h.value=c.toString(),w.checked=p,a.classList.remove("hidden"),console.log("Modal de edición abierto correctamente")):console.error("No se encontraron elementos del modal de edición")}function u(){const e=document.getElementById("edit-product-modal");e&&(e.classList.add("hidden"),l=null)}function x(e,r){console.log("Abriendo modal de eliminación para:",r),s=e;const n=document.getElementById("delete-product-modal"),t=document.getElementById("delete-product-name");n&&t?(t.textContent=r,n.classList.remove("hidden"),console.log("Modal de eliminación abierto correctamente")):console.error("No se encontraron elementos del modal de eliminación")}function m(){const e=document.getElementById("delete-product-modal");e&&(e.classList.add("hidden"),s=null)}function B(){if(!s){i("Error: No hay producto seleccionado para eliminar","error");return}console.log("Eliminando producto:",s);const e=document.querySelector('#delete-product-modal button[onclick="confirmDeleteProduct()"]'),r=e.textContent||"Eliminar";e.textContent="Eliminando...",e.disabled=!0,k(s).then(n=>{n.success?(i("¡Producto eliminado exitosamente!","success"),m(),setTimeout(()=>{window.location.reload()},1500)):(i("Error al eliminar el producto","error"),console.error("Error eliminando producto:",n.error))}).catch(n=>{console.error("Error:",n),i("Error al eliminar el producto","error")}).finally(()=>{e.textContent=r,e.disabled=!1})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("edit-product-form");e?.addEventListener("submit",async t=>{if(t.preventDefault(),!l){i("Error: No hay producto seleccionado","error");return}const d=new FormData(e),o={name:d.get("name"),description:d.get("description"),price:parseFloat(d.get("price")),image:d.get("image"),category:d.get("category"),stock:parseInt(d.get("stock")),featured:d.get("featured")==="on"};if(!o.name||!o.description||!o.image||!o.category){i("Por favor completa todos los campos requeridos","error");return}if(o.price<=0){i("El precio debe ser mayor a 0","error");return}if(o.stock<0){i("El stock no puede ser negativo","error");return}const c=e.querySelector('button[type="submit"]'),p=c.textContent||"Guardar Cambios";c.textContent="Guardando...",c.disabled=!0;try{console.log("Actualizando producto:",l,"con datos:",o),(await b(l,{name:o.name,description:o.description,price:o.price,image:o.image,category:o.category,stock:o.stock,featured:o.featured})).success?(i("¡Producto actualizado exitosamente!","success"),u(),setTimeout(()=>{window.location.reload()},1500)):i("Error al actualizar el producto","error")}catch(a){console.error("Error:",a),i("Error al actualizar el producto","error")}finally{c.textContent=p,c.disabled=!1}});const r=document.getElementById("edit-product-modal");r&&r.addEventListener("click",t=>{t.target===r&&u()});const n=document.getElementById("delete-product-modal");n&&n.addEventListener("click",t=>{t.target===n&&m()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&(u(),m())})});function i(e,r){document.querySelectorAll(".snackbar-notification").forEach(o=>o.remove());const t=document.createElement("div");t.className=`snackbar-notification fixed top-4 right-4 px-6 py-4 rounded-lg text-white font-medium z-50 transform translate-x-full transition-transform duration-300 ease-in-out ${r==="success"?"bg-green-600 border border-green-500 shadow-lg":"bg-red-600 border border-red-500 shadow-lg"}`;const d=r==="success"?'<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>':'<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>';t.innerHTML=`
      <div class="flex items-center">
        ${d}
        <span>${e}</span>
        <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200 transition-colors duration-200">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.remove("translate-x-full")},100),setTimeout(()=>{t.parentElement&&(t.classList.add("translate-x-full"),setTimeout(()=>{t.remove()},300))},4e3)}window.openEditProductModal=I;window.closeEditProductModal=u;window.openDeleteProductModal=x;window.closeDeleteProductModal=m;window.confirmDeleteProduct=B;
